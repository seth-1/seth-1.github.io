<!DOCTYPE html>
<html lang="en-us">

  <head>
  <meta charset="UTF-8">
  <title>Biosynthesis of natural products</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <link rel="stylesheet" href="/css/normalize.css">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/css/cayman.css">
</head>

  <body>
    <section class="page-header">
  <h1 class="project-name">Biosynthesis of natural products</h1>
  <h2 class="project-tagline">Tutorials for the fungal project</h2>
  <!-- <a href="gettingStarted.html" class="btn">Getting started</a> -->
  <!-- <a href="tutorials.html" class="btn">Tutorials</a> -->
  <!-- <a href="exercises.html" class="btn">Exercises</a> -->
  <!-- <a href="supplementary.html" class="btn">Supplementary</a> -->
</section>


    <section class="main-content">

      <h1 id="why-working-with-r">Why working with R?</h1>

<p>Antismash is already providing many functions and analysis tools in it’s web interface. However, projects often involve newly sequenced organisms that are not available in public databases yet and only owned by you. Therefore, you have to perform certain analyses on your own, including unpublished and non analysed data.</p>

<p>Learning R will help you in handling the increasing  amount of data. Projects working on 100 to 300 genomes simultaneously are common and certain projects combine analyses of <a href="http://genome.jgi.doe.gov/programs/fungi/1000fungalgenomes.jsf">1000 genomes</a>.</p>

<p><img src="https://cdn.meme.am/cache/instances/folder204/65722204.jpg" alt="all genomes" /></p>

<p>More data will become available and it will become increasingly important to work on these in a high throughput as well as reproducible manner.</p>

<h1 id="working-with-r">Working with R</h1>

<p>In this tutorial you will find code examples (snippets) and exercises. Type the snippets into your R script and execute them. Inspect what the functions do. Afterwards, try the exercises beneath the snippets.</p>

<h2 id="r-basics">R basics</h2>

<p>R works with vectors of different kinds which is similar to other programming languages. However, the syntax is a bit different. <code class="highlighter-rouge">c()</code> in the example below is a function which <em>concatenates</em> the numeric values <em>1,2,3,4,5</em> to a numeric vector.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>a &lt;- c(1,2,3,4,5) # assigns a numeric vector from 1 to 5 to the variable a
a &lt;- seq(5)       # does the same as the line above using the seq function
sum(a)            # calculates the sum of a
length(a)
class(a)


letters          
class(letters)
b &lt;- letters[1:20] # subsetting for first to 20th character
c &lt;- letters[10:20]
d &lt;- letters[15:25]
union(b,c,d)

</code></pre>
</div>

<ul>
  <li>What do the <code class="highlighter-rouge">length()</code> and <code class="highlighter-rouge">class()</code> functions tell you?</li>
  <li>How does the <code class="highlighter-rouge">union()</code> function differ from the <code class="highlighter-rouge">c()</code> function?</li>
  <li>How can you find the shared characters between b and c? Tip: Try the help function on <code class="highlighter-rouge">union()</code></li>
  <li>Try out the function on objects b and c you found in the last</li>
</ul>

<h2 id="reading-data-into-r">Reading data into R</h2>

<p>Often you download datasets from different sources. Either a database, or you want to inspect the output of a program like antismash or interpro.
We can read in data using functions. You can download the file example.tsv <a href="example.tsv">here</a></p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">dat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.table</span><span class="p">(</span><span class="s2">"example.tsv"</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'\t'</span><span class="p">,</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> </span><span class="c1"># Reading example file
</span><span class="n">head</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span><span class="w">                                    </span><span class="c1"># Showing the header
</span><span class="n">str</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span><span class="w">                                     </span><span class="c1"># Overview of observations (rows) and variables (columns)
</span></code></pre>
</div>

<ul>
  <li>Why do we need the sep and header argument? Try the help function of read.table to find the answer (Tip: tsv stands for tab separated values).</li>
</ul>

<p>In the following tutorial we will use built in datasets for reasons of simplicity. In the exercises you will work on the secondary metabolite annotations.</p>

<h2 id="data-frames-and-built-in-datasets">Data frames and built in datasets</h2>

<p>R’s most common data structure is the data frame which is a table containing different numeric values, as well as descriptive values like characters or factors. R has a few build in datasets like the iris dataset.</p>

<blockquote>
  <p>This famous (Fisher’s or Anderson’s) iris data set gives the measurements in centimeters of the variables sepal length and width and petal length and width, respectively, for 50 flowers from each of 3 species of iris. The species are Iris setosa, versicolor, and virginica.</p>
</blockquote>

<h2 id="data-overview">Data Overview</h2>

<p>To get an overview of your data you can use the <code class="highlighter-rouge">head()</code> and <code class="highlighter-rouge">str()</code> function or simply print the object to console by typing the variables name and executing the line. Alternatively you can inspect your data in Rstudio using the <strong>environment panel</strong>.</p>

<p><img src="figures/viewDatasets.gif" alt="viewing data" /></p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">head</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span><span class="w">
  </span><span class="n">Sepal.Length</span><span class="w"> </span><span class="n">Sepal.Width</span><span class="w"> </span><span class="n">Petal.Length</span><span class="w"> </span><span class="n">Petal.Width</span><span class="w"> </span><span class="n">Species</span><span class="w">
</span><span class="m">1</span><span class="w">          </span><span class="m">5.1</span><span class="w">         </span><span class="m">3.5</span><span class="w">          </span><span class="m">1.4</span><span class="w">         </span><span class="m">0.2</span><span class="w">  </span><span class="n">setosa</span><span class="w">
</span><span class="m">2</span><span class="w">          </span><span class="m">4.9</span><span class="w">         </span><span class="m">3.0</span><span class="w">          </span><span class="m">1.4</span><span class="w">         </span><span class="m">0.2</span><span class="w">  </span><span class="n">setosa</span><span class="w">
</span><span class="m">3</span><span class="w">          </span><span class="m">4.7</span><span class="w">         </span><span class="m">3.2</span><span class="w">          </span><span class="m">1.3</span><span class="w">         </span><span class="m">0.2</span><span class="w">  </span><span class="n">setosa</span><span class="w">
</span><span class="m">4</span><span class="w">          </span><span class="m">4.6</span><span class="w">         </span><span class="m">3.1</span><span class="w">          </span><span class="m">1.5</span><span class="w">         </span><span class="m">0.2</span><span class="w">  </span><span class="n">setosa</span><span class="w">
</span><span class="m">5</span><span class="w">          </span><span class="m">5.0</span><span class="w">         </span><span class="m">3.6</span><span class="w">          </span><span class="m">1.4</span><span class="w">         </span><span class="m">0.2</span><span class="w">  </span><span class="n">setosa</span><span class="w">
</span><span class="m">6</span><span class="w">          </span><span class="m">5.4</span><span class="w">         </span><span class="m">3.9</span><span class="w">          </span><span class="m">1.7</span><span class="w">         </span><span class="m">0.4</span><span class="w">  </span><span class="n">setosa</span><span class="w">

</span><span class="o">&gt;</span><span class="w"> </span><span class="n">str</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span><span class="w">
</span><span class="s1">'data.frame'</span><span class="o">:</span><span class="w">	</span><span class="m">150</span><span class="w"> </span><span class="n">obs.</span><span class="w"> </span><span class="n">of</span><span class="w">  </span><span class="m">5</span><span class="w"> </span><span class="n">variables</span><span class="o">:</span><span class="w">
 </span><span class="o">$</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="o">:</span><span class="w"> </span><span class="n">num</span><span class="w">  </span><span class="m">5.1</span><span class="w"> </span><span class="m">4.9</span><span class="w"> </span><span class="m">4.7</span><span class="w"> </span><span class="m">4.6</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">5.4</span><span class="w"> </span><span class="m">4.6</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">4.4</span><span class="w"> </span><span class="m">4.9</span><span class="w"> </span><span class="n">...</span><span class="w">
 </span><span class="o">$</span><span class="w"> </span><span class="n">Sepal.Width</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">num</span><span class="w">  </span><span class="m">3.5</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3.2</span><span class="w"> </span><span class="m">3.1</span><span class="w"> </span><span class="m">3.6</span><span class="w"> </span><span class="m">3.9</span><span class="w"> </span><span class="m">3.4</span><span class="w"> </span><span class="m">3.4</span><span class="w"> </span><span class="m">2.9</span><span class="w"> </span><span class="m">3.1</span><span class="w"> </span><span class="n">...</span><span class="w">
 </span><span class="o">$</span><span class="w"> </span><span class="n">Petal.Length</span><span class="o">:</span><span class="w"> </span><span class="n">num</span><span class="w">  </span><span class="m">1.4</span><span class="w"> </span><span class="m">1.4</span><span class="w"> </span><span class="m">1.3</span><span class="w"> </span><span class="m">1.5</span><span class="w"> </span><span class="m">1.4</span><span class="w"> </span><span class="m">1.7</span><span class="w"> </span><span class="m">1.4</span><span class="w"> </span><span class="m">1.5</span><span class="w"> </span><span class="m">1.4</span><span class="w"> </span><span class="m">1.5</span><span class="w"> </span><span class="n">...</span><span class="w">
 </span><span class="o">$</span><span class="w"> </span><span class="n">Petal.Width</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">num</span><span class="w">  </span><span class="m">0.2</span><span class="w"> </span><span class="m">0.2</span><span class="w"> </span><span class="m">0.2</span><span class="w"> </span><span class="m">0.2</span><span class="w"> </span><span class="m">0.2</span><span class="w"> </span><span class="m">0.4</span><span class="w"> </span><span class="m">0.3</span><span class="w"> </span><span class="m">0.2</span><span class="w"> </span><span class="m">0.2</span><span class="w"> </span><span class="m">0.1</span><span class="w"> </span><span class="n">...</span><span class="w">
 </span><span class="o">$</span><span class="w"> </span><span class="n">Species</span><span class="w">     </span><span class="o">:</span><span class="w"> </span><span class="n">Factor</span><span class="w"> </span><span class="n">w</span><span class="o">/</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="n">levels</span><span class="w"> </span><span class="s2">"setosa"</span><span class="p">,</span><span class="s2">"versicolor"</span><span class="p">,</span><span class="n">..</span><span class="o">:</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">...</span><span class="w">
</span></code></pre>
</div>

<p>Quick recap of plant biology:
<!-- ![iris flower anatomy](https://upload.wikimedia.org/wikipedia/commons/4/49/Iris_germanica_%28Purple_bearded_Iris%29%2C_Wakehurst_Place%2C_UK_-_Diliff.jpg) --></p>

<p><img src="http://plant-life.org/Orchidaceae/orchid3.gif" alt="orchid anatomy" /></p>

<h2 id="subsetting">Subsetting</h2>

<p>Data frames and other types of data can be subsetted to concentrate on certain groups of organisms, enzymes etc. We need to cover some more concepts to understand subsetting.</p>

<p>Try the following lines and describe what you get as a result:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">iris</span><span class="w">
</span><span class="n">iris</span><span class="o">$</span><span class="n">species</span><span class="w">
</span><span class="n">iris</span><span class="o">$</span><span class="n">species</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">'setosa'</span><span class="w">
</span><span class="n">subset</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="n">Species</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">'setosa'</span><span class="p">)</span><span class="w"> </span><span class="c1"># same as above
</span><span class="n">iris</span><span class="o">$</span><span class="n">species</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s1">'setosa'</span><span class="p">,</span><span class="w"> </span><span class="s1">'versicolor'</span><span class="p">)</span><span class="w">
</span><span class="n">iris</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">),]</span><span class="w">
</span><span class="n">iris</span><span class="p">[,</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">)]</span><span class="w">
</span></code></pre>
</div>

<p>We combine now two terms to subset our data frame:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">iris</span><span class="p">[</span><span class="n">iris</span><span class="o">$</span><span class="n">species</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">'setosa'</span><span class="p">,]</span><span class="w">
</span></code></pre>
</div>

<p>Theres a lot of commands in that one line of code. On the outside we tell R to access the rows of the data frame <code class="highlighter-rouge">iris[rows,columns]</code> and on the inside we create a boolean vector (TRUE, FALSE statement) checking the whole column of <code class="highlighter-rouge">iris$species</code> if they are containing the term <code class="highlighter-rouge">'setosa'</code>. Remember that single <code class="highlighter-rouge">=</code> will mean an assignment operation like in <code class="highlighter-rouge">a = 1</code> and only double equation marks <code class="highlighter-rouge">==</code> will create a comparison.</p>

<h2 id="merging">Merging</h2>

<p>Often we need to combine</p>

<h2 id="ggplot2-basics">ggplot2 basics</h2>

<p>ggplot2 requires your dataframe in the first argument <code class="highlighter-rouge">ggplot(yourDataFrame)</code> afterwards you specify the type of plot like e.g. <code class="highlighter-rouge">geom_point()</code> and set the aesthetic mapping inside the latter function. Aesthetics tell ggplot the variables for each axis <code class="highlighter-rouge">x,y</code> and the groups you want to specify by <code class="highlighter-rouge">color</code>.
In the follwing example we use the standard R iris dataset and plot length of petals against length of sepals.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">))</span><span class="w">
</span></code></pre>
</div>
<p><img src="figures/ggplotExample.png" alt="ggplotBasics" /></p>

<h3 id="using-more-geoms">Using more geoms</h3>

<p>Geoms are the types of plots you can create with ggplot2. Try typing <code class="highlighter-rouge">geom_</code> in Rstudio and see what Rstudio suggests to you.</p>

<p>One useful geom is the histogram <code class="highlighter-rouge">geom_histogram</code>. This time we specify <em>fill</em> to color the inside of the plot objects. Above we had to use color because it affects the stroke of the plot data. In the below example we need to use the <code class="highlighter-rouge">factor()</code> function to create groups of data from numeric data. Try <code class="highlighter-rouge">mtcars$gear</code> vs <code class="highlighter-rouge">factor(mtcars$gear)</code>, what is the difference?</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">head</span><span class="p">(</span><span class="n">mtcars</span><span class="p">)</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="n">mtcars</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cyl</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">gear</span><span class="p">)),</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'dodge'</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="figures/carsHistoDodged.png" alt="carsHistogram" /></p>

<!-- ggplot(mtcars) + geom_histogram(aes(x = cyl, fill = factor(gear)), position = 'dodge') +scale_x_continuous(breaks = c(4,6,8), labels = c('low','mid','high')) -->

<h3 id="more-basic-functions">More basic functions</h3>

<h4 id="aggregate">aggregate</h4>

<p>The aggregate function is very helpful for summary statistics. In case you want to know, e.g. what the average petal length per species is. Aggregates syntax follows <code class="highlighter-rouge">aggregate(varOfInterest ~ groupVar)</code>.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">aggregate</span><span class="p">(</span><span class="n">Petal.Length</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">FUN</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">mean</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<ul>
  <li>What is the mean Petal.Length for each species?</li>
  <li>What is the mean Sepal.Width for each species?</li>
</ul>

<h4 id="merge">merge</h4>

<p>Often you want to merge datasets. E.g. if you have annotation data from different sources. Let’s merge the iris dataset with a (completely made up) dataset of poisonus iris species.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w">
</span><span class="n">iris</span><span class="w">

</span><span class="n">poison</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="w">
  </span><span class="n">poisonous</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s1">'poisonous'</span><span class="p">,</span><span class="w"> </span><span class="s1">'non-poisonous'</span><span class="p">,</span><span class="w"> </span><span class="s1">'non-poisonous'</span><span class="p">),</span><span class="w">
  </span><span class="n">Species</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s1">'setosa'</span><span class="p">,</span><span class="w"> </span><span class="s1">'virginica'</span><span class="p">,</span><span class="w"> </span><span class="s1">'versicolor'</span><span class="p">)</span><span class="w">
  </span><span class="p">)</span><span class="w">

</span><span class="n">pplants</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">merge</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="n">poison</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Species"</span><span class="p">)</span><span class="w">

</span><span class="n">pplants</span><span class="w"> </span><span class="c1"># What happened to the dataset?
</span><span class="w">
</span><span class="n">aggregate</span><span class="p">(</span><span class="w"> </span><span class="n">Petal.Length</span><span class="o">~</span><span class="n">poisonous</span><span class="p">,</span><span class="w"> </span><span class="n">pplants</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span><span class="w">

</span></code></pre>
</div>

<ul>
  <li>What does the last line tell us about the anatomy of poisonous plants?</li>
</ul>

<h4 id="split">split</h4>

<p>Split let’s you split a data frame into a list. This is helpful for many downstream applications and readability (more on this later).</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">irisL</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">split</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">)</span><span class="w"> </span><span class="c1"># creating a list of the iris dataset
</span><span class="w">
</span><span class="n">iris</span><span class="w"> </span><span class="c1"># print and see
</span><span class="w">
</span><span class="n">irisL</span><span class="p">[</span><span class="s1">'versicolor '</span><span class="p">]</span><span class="w">
</span><span class="n">irisL</span><span class="p">[[</span><span class="s1">'versicolor '</span><span class="p">]]</span><span class="w">

</span></code></pre>
</div>
<ul>
  <li>What is the difference between the last two statements? Tip: Use the <code class="highlighter-rouge">class()</code> function on the sublist of <em>versicolor</em> species but also print it to spot the difference</li>
</ul>

<h3 id="introduction-to-lapply-and-sapply">Introduction to lapply and sapply</h3>

<p>The apply family of functions working similar to for-loops, meaning:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">nrow</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span><span class="w"> </span><span class="c1"># will give you the number of rows for the entire data frame
</span><span class="w">
</span><span class="n">irisL</span><span class="w">

</span><span class="k">for</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">irisL</span><span class="p">){</span><span class="w">
  </span><span class="n">nrow</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">lapply</span><span class="p">(</span><span class="n">irisL</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="p">)</span><span class="w"> </span><span class="c1"># Is basically the same as above.
</span><span class="w">
</span><span class="n">lapply</span><span class="p">(</span><span class="n">irisL</span><span class="p">,</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">){</span><span class="w">
  </span><span class="n">x</span><span class="w">
  </span><span class="p">})</span><span class="w">

</span></code></pre>
</div>

<p>The function <code class="highlighter-rouge">lapply()</code> will retain the list structure while <code class="highlighter-rouge">sapply()</code> is simplifying the result to a vector.</p>

<h3 id="almost-done-heatmaps-in-r">Almost done: Heatmaps in R</h3>

<p>Heatmaps are excellent to show relationships of e.g. organisms in large datasets. Given a similarity matrix we can create a plot which provides us with additional clustered information. We will need to introduce the matrix as another data object.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">gplots</span><span class="p">)</span><span class="w">

</span><span class="n">speciesNames</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">unique</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">)</span><span class="w">

</span><span class="n">exampleMat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">100</span><span class="p">,</span><span class="m">70</span><span class="p">,</span><span class="m">50</span><span class="p">,</span><span class="m">70</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">85</span><span class="p">,</span><span class="m">50</span><span class="p">,</span><span class="m">85</span><span class="p">,</span><span class="m">100</span><span class="p">),</span><span class="w">
       </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w">
       </span><span class="n">dimnames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">speciesNames</span><span class="p">,</span><span class="w"> </span><span class="n">speciesNames</span><span class="p">))</span><span class="w"> </span><span class="c1"># dimnames needs a list for row- and columnnames
</span><span class="n">exampleMat</span><span class="w">

</span><span class="n">heatmap.2</span><span class="p">(</span><span class="n">exampleMat</span><span class="p">,</span><span class="w">
          </span><span class="n">trace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'none'</span><span class="p">,</span><span class="w">
          </span><span class="n">margins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">10</span><span class="p">,</span><span class="m">10</span><span class="p">)</span><span class="w">
          </span><span class="p">)</span><span class="w">

</span></code></pre>
</div>

<ul>
  <li>What does the heatmap tell you about the releationship of the iris species?</li>
</ul>

<blockquote>
  <p>Well done, you finished the tutorial! Now try out your R skills in the exercises.</p>
</blockquote>

<h1 id="more-info-on-r">More info on R</h1>

<p>A more detailed introduction to R can be found on another <a href="https://cmgbiotech.wordpress.com/tutorials/introduction-to-r/">course page</a></p>


<!-- <nav class="nav-primary" role="navigation" >
    <ul>
        
        <li>
        	<a  href="/compoundMining.html">compounds</a>
        </li>
        
        <li>
        	<a  href="/exercises.html">Exercises</a>
        </li>
        
        <li>
        	<a  href="/gettingStarted.html">Getting started with R</a>
        </li>
        
        <li>
        	<a  href="/">{}</a>
        </li>
        
        <li>
        	<a  href="/supplementary.html">Supplementary info</a>
        </li>
        
        <li>
        	<a class="active" href="/tutorials.html">Tutorials</a>
        </li>
        
        <li>
        	<a  href="/page2/">{}</a>
        </li>
        
    </ul>
</nav>
 -->

      <footer class="site-footer">
  <!-- <span class="site-footer-owner"><a href="http://localhost:4000">Biosynthesis of natural products</a> is maintained by <a href="seth-1.github.io">Sebastian Theobald</a>.</span> -->
  <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>
</footer>


    </section>

  </body>
</html>
